1. test everything

2. code refactoring